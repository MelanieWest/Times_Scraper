<style>
  #articles {
    display: inline-block;
    overflow: auto;
    width: 60%;
    height: 700px;
  }

  #notes {
    float: right;
    width: 30%;
  }

  textarea,
  input {
    display: block;
    width: 100%;
    background-color: #FCF5C7;
  }

  input {
    height: 36px;
    font-size: 24px;
  }

  textarea {
    height: 200px;
    font-size: 18px;
  }
</style>
<div>


  <div id="articles" class="col-4">

    <h4>New York Times Articles </h4>

    <ul>
      {{#each data }}
      <li>
 
        {{!-- <form action="/update/{{this._id}}" method="POST"> --}}
        <form action="/articles/{{this._id}}" method="post">
          <h3>{{this.title}}</h3>
          <br>
          <h4>Link :
            <a href="{{this.link}}" target="_blank">{{this.link}}</a>
          </h4>
          <button class ="note-add" type="submit" val={{this._id}}>Add Note</button>
          <button id="remove" type="button" value="{{this._id}}"> Remove </button>
        </form>
      </li>
      {{/each}}
    </ul>
  </div>

  <div id="myModal" class="modal fade" role="dialog">
    <div class="modal-dialog">

        <!-- Modal content-->
        <div class="modal-content">
            <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal">&times;</button>
                <h4 class="modal-title">Notes</h4>
                <input type="hidden" id="recId" name="recId" value=""></input>
            </div>

            <div class="modal-body">
                <p>Note Title</p>
                <input type="text" id="noteTitle" />
                <p>Note</p>
                <textarea id="noteBody"></textarea>
            </div>
            <div class="modal-footer">
                <button type="button" id="addNote" class="btn btn-default" data-dismiss="modal">Save</button>
            </div>
        </div>
    </div>
</div>
</div>




<script src ="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.2.1/jquery.min.js"></script>


<script>
    $(document).ready(function () {
        var currentURL = window.location.origin;
        //set database id as hiden field on toggle to later insert note in db with correct article
        $(".note").on("click", function () {
            //get article id to find existing notes if any
            var thisId = $(this).val();
            //reset note body (otherwise keeps value of previous note)
            $("#noteTitle").val("");
            $("#noteBody").val("");
            //toggle modal
            $("#myModal").modal('toggle');
            // set id as hidden field to save the note
            $("#recId").val($(this).val());
            // Now make an ajax call for the Article
            $.ajax({
                method: "GET",
                url: "/articles/" + thisId
            })
                // With that done, add the note information to the page
                .done(function (data) {
                    console.log(data);
                    // If there's a note in the article
                    if (data.note) {
                        // Place the title of the note in the title input
                        $("#noteTitle").val(data.note.title);
                        // Place the body of the note in the body textarea
                        $("#noteBody").val(data.note.body);
                    }
                });
        });
        $("#addNote").on("click", function () {
            //save note to an article
            var userData = {
                id: $("#recId").val(),
                title: $("#noteTitle").val(),
                note: $("#noteBody").val()
            }
            $.post(currentURL + "/articles/:userData.id", userData, function (data) {
            });
        });
        $("#remove").on("click", function () {
            //delete an article
            var url = currentURL + "/delete/" + $(this).val();
            console.log(url);
            $.post(url, function (data) {
                window.location.reload();
            });
        });
    });
</script>














{{!-- 
 <script>


  // Whenever someone clicks a 'note-add' button
  $(".note-add").on("click", function () {
    // Empty the notes from the note section
    $("#notes").empty();
    // Save the id from the p tag
    var thisId = $(this).val();
    console.log('thisId = ',thisId);

    // Now make an ajax call for the Article
    $.ajax({
      method: "GET",
      url: "/articles/" + thisId
    })
      // With that done, add the note information to the page
      .done(function (data) {
        console.log("add notes data: " + data.title);
        // The title of the article
        $("#notes").append("<h2>" + data.title + "</h2>");
        // An input to enter a new title
        $("#notes").append("<input id='titleinput' name='title' >");
        // A textarea to add a new note body
        $("#notes").append("<textarea id='bodyinput' name='body'></textarea>");
        // A button to submit a new note, with the id of the article saved to it
        $("#notes").append("<button data-id='" + data._id + "' id='savenote'>Save Note</button>");

        // If there's a note in the article
        if (data.note) {
          // Place the title of the note in the title input
          $("#titleinput").val(data.note.title);
          // Place the body of the note in the body textarea
          $("#bodyinput").val(data.note.body);
        }
      });
  });

  // When you click the savenote button
  $("#savenote").on("click", function () {
    // Grab the id associated with the article from the submit button
    var thisId = $(this).attr('data-id');

    // Run a POST request to change the note, using what's entered in the inputs
    $.ajax({
      method: "POST",
      url: "/articles/" + thisId,
      data: {
        // Value taken from title input
        title: $("#titleinput").val(),
        // Value taken from note textarea
        body: $("#bodyinput").val()
      }
    })
      // With that done
      .done(function (data) {
        // Log the response
        console.log(data);
        // Empty the notes section
        $("#notes").empty();
      });

    // Also, remove the values entered in the input and textarea for note entry
    $("#titleinput").val("");
    $("#bodyinput").val("");
  });


  });
</script> --}}